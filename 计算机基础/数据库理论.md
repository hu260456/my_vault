### 基本概念

- Data
  - ==是数据库中存储的基本对象==
  - ==是描述事物的符号记录==
  - ==数据由 DBMS 统一管理和控制==
- DB
  - ==是长期存储在计算机内有组织的、可共享的大量数据的集合==
  - 数据库拥有==永久存储、有组织、可共享==三个基本特点
  - 数据库中的数据按一定的数据模型组织、描述和储存，具有较小的冗余度、较高的数据独立性和易扩展性，并可为各种用户共享。
- DBMS
	- ==是位于用户和操作系统之间的一层数据管理软件==
	- 和操作系统一样是计算机的基础软件
	- 主要功能
	    - 数据定义功能
			- 提供 DDL，用户可以方便得对数据库中的对象进行定义
	    - 数据组织、存储和管理
	    - 数据操纵功能
	    - 数据库的事务管理和运行管理
	    - 数据库的建立和维护功能
	    - 其他功能(通信功能，数据转换功能，互访和互操作功能等)
- DBA
	- 数据管理人员
- DBS
    - 是由 ==DB、DBMS（、支持 DMBMS 运行的 OS）、APP、DBA== 组成的存储、管理、处理和维护数据的系统
    - 特点
	    - 数据结构化
	    - 数据的共享性高、冗余度低而且容易扩充
	    - 数据独立性高
	    - 数据由数据库管理系统统一管理和控制

### 数据管理技术的发展历程

#### 人工管理阶段

- 数据不保存在磁盘，由应用程序管理数据
- 数据不共享
- 数据不具有独立性

#### 文件系统阶段

- 数据可以长期保存
- 由文件系统管理数据
- 数据共享性差，冗余度大
- 数据独立性差

#### 数据库管理阶段

- 数据结构化
- 数据共享性高、冗余度低、易扩充
- 数据独立性高
- 数据由 DBMS 统一管理和控制

##### 补充：数据独立性

- 物理独立性：是指用户的应用程序与数据库中数据的物理存储是相互独立的，数据的物理存储改变，应用程序不改变
- 逻辑独立性：是指用户的应用程序与数据库中数据的逻辑结构是相互独立的，数据的逻辑结构改变，应用程序不改变

### 数据模型

- 数据模型的组成要素
	- ==数据结构==
	- ==操作数据==
	- ==完整性约束==
- 数据模型是对现实世界数据特征的抽象，是现实世界的模拟
- 数据模型应该满足
	- 较为真实地模拟现实世界
	- 容易为人所理解
	- 便于在计算机实现
- 数据模型的分类
	- ==概念模型==（信息模型）
		- 按用户的观点来对数据和信息建模，主要用于数据库设计
		- 是现实世界到机器世界的一个中间层次
	    - 是现实世界到信息世界的第一层抽象
	    - 是数据库设计人员进行数据库设计的有力工具
	    - 是数据库设计人员和用户之间进行交流的语言
		- 概念模型要求
		    - 具有较强的语义表达能力
		    - 能够方便、直接地表达应用中的各种语义知识
		    - 简单、清晰、易于用户理解
		- 实体-联系法：概念模型的一种表示方法
			- 用 E-R 图来描述现实世界的概念模型
			- 使用E-R 方法描述的概念模型也称为 E-R 模型
	- ==逻辑模型==
		- 按计算机系统的观点对数据建模
		- 主要用于数据库管理系统的实现
		- 包括
			- 层次模型
			- 网状模型
			- 关系模型
			- 面向对象模型
			- 对象关系模型
	- ==物理模型==
		- 述数据在系统内部的表示方法和存取方法，或在磁盘或磁带上的存取方法
		- 是对数据最底层的抽象
		- 是面向计算机系统的

### 信息世界中的基本概念

- 实体
	- 客观存在并可相互区别的事物
	- 可以是具体的人，也可以是抽象的概念或联系
- 实体型
	- 用实体名及其属性集合来抽象和刻画同类实体
- 实体集
	- 一类型实体的集合
- 属性
	- 实体所具有的特性
- 码
	- 唯一标识实体的属性
- 联系
	- 实体之间的联系通常是指不同实体集之间的联系
	- 实体之间的联系有一对一、一对多和多对多
	- 实体内部的联系通常是指实体各属性之间的联系

### 数据库系统结构

- 模式的概念
	- 数据库中全体数据的 ==逻辑结构== 和 ==特征== 的描述，它仅仅涉及型的描述，不涉及具体的值
	- 同一个模式可以有很多个实例
- 三级模式结构
	- 外模式（子模式、用户模式或应用模式）
		- 通常是模式的子集
		- 一个数据库可以有多个外模式
		- 同一外模式可以为某一用户的多个应用系统所使用，但一个应用程序只能使用一个外模式
		- 外模式是保证数据库安全性的一个有力措施，每个用户只能看见和访问所对应的外模式中的数据，数据库中的其余数据是不可见的
	- 模式（概念模式、逻辑模式）
	- 内模式（物理模式、存储模式）
- 两级映射
	- 模式/内模式映像
		- 内模式和模式之间的转化
		- 当数据库的存储结构改变时，由数据库管理员对模式/内模式作相应改变，可以使模式保持不变，从而应用程序不用改变
		- 保证了数据与程序的物理独立性
	- 外模式/模式映像
		- 外模式和模式之间的转化
		- 当模式改变时，由数据库管理员对各个外模式/模式映像作相应改变，可以使外模式保持不变，从而应用程序不必修改
		- 保证了数据与程序的逻辑独立性

### 关系型数据库

#### 基本概念

- 现实世界中实体以及实体间的联系均用关系表示
- 从用户角度，关系模型中数据的逻辑结构是一张二维表
- 关系模型是建立在集合代数的基础上
- 域（Domain），是一组具有相同数据类型的值的集合
- 笛卡尔积
- 基数
- 目（度）
	- 目为 1 的关系称作 ==单元关系==
	- 目为 2 的关系称作 ==二元关系==
- 三类关系
	- 基本关系
		实际存在的表，是存储实际数据的逻辑表示
	- 查询表
		查询结果对应的表
	- 视图表
		由基本表或其他视图表导出的表，是虚表，不对应实际存储的数据
- 基本关系的性质
	- 列是同质的
	- 列（行）的次序无所谓，可以任意交换
	- 分量必须取原子值（第一范式）
- 关系模式
	- 是对关系的描述
	- 可以形象得表示为 R(U, D, Dom, F)
		- R: 关系名
		- U: 组成该关系的属性集合
		- D: 属性组 U 中属性的域
		- Dom: 属性到域的映射
		- F: U 上的一组数据依赖
- 关系数据结构
	- 基本操作
		- 查询
			- 基本操作
				- 选择、投影、并、差、笛卡尔积
			- 进阶操作
				- 连接、除、交等
		- 数据修改
			- 插入
			- 删除
			- 修改
- 关系数据库语言的分类
	- ==关系代数==语言（如：ISBL）
	- ==关系演算==语言
		- 元组关系演算语言（如 APLHA、QUEL）
		- 域关系演算语言（如：QBE）
	- SQL 语言
- 关系的完整性
	- ~~数据库的正确性：==符合对现实世界的描述==~~（放错地方了）
	- 数据库的相容性：一对象在不同表里面是符合逻辑的，比如我的地址，年龄在两个表里面都应一致
	- 实体完整性
		- 主码唯一且非空
	- 参照完整性
		- 外码要么为空，要么对应另一表的主码
	- 用户自定义完整性
		- 如非空约束、取值范围约束等

#### 关系代数

- 关系代数是一种抽象的查询语言，它用对关系的运算来表达查询
- 三大要素
	- 运算对象（关系）
	- 运算符（集合运算符和专门的关系运算符）
	- 运算结果（关系）
- 运算分类
	- 集合运算
		- 并
		- 差
		- 交
		- 笛卡尔积
	- 专门的关系运算
		- 选择
		- 投影
		- 连接 (${R}\Join_{{A}\theta{B}}{S}$)
			- 等值连接
				$\theta$ 为 '='
			- 自然连接
				- 将两关系的共同属性进行等值连接，结果只保留一组共同属性
				- 是一种特殊的等值连接
				- 不用写任何比较符号
			- 外连接
				- 全外连接
					- 保留所有悬浮元组，其他属性置空
				- 左外连接
					- 保留左关系的悬浮元组，其他属性置空
				- 右外连接
					- 保留右关系的悬浮元组，其他属性置空
		- 除
			- ${R}\div{S}$，表示保留 R 中满足 S 的，而且 R 中列要去掉 S 的列
			- ![[attachments/Pasted image 20240624022943.png]]
			- ![[attachments/Pasted image 20240624023226.png]]

#### SQL 语言（标准SQL）

- SQL 语言结构
	- DDL 数据定义语言
		- 数据定义语言主要用来定义逻辑结构（包括定义基本表，视图和索引）、删除表和修改表
	- DQL 数据查询语言
		- 数据查询语言主要用来对数据库中的各种数据对象进行查询
	- DML 数据操纵语言
		- 数据操纵语言用于改变数据库中的数据，包括插入，删除，修改
	- DCL 数据控制语言
		- 据控制语言，对表和视图的授权，完整性规则的描述以及事务开始和结束等控制语句
- SQL 的特点
	- 综合统一（独立完成数据库命周期中的全部活动，包括定义关系模式、录入数据、建立数据库、查询、更新、维护、数据库重构）
	- 高度非过程化（用户只需提出“做什么”，而不必指明“怎么做”）
	- 面向集合的操作方式
	- 以同一种语法结构提供两种使用方式（SQL既是自含式语言，又是嵌入式语言。SQL语句能够嵌入到高级语言程序中，）
	- 语言简洁，易学易用（SQL语言语法简单，接近英语，因此容易学习，也容易使用。）

#### 索引

- 建立索引可以加快查询速度
- DBA 与 表主可以建立索引
- 索引可以建在一列或多列上
- DBMS 一般会自动建立 ==`PRIMARY KEY`== 和 ==`UNIQUE`== 列上的索引
- DBMS 自动完成索引的维护
- DBMS 自动选择是否使用索引以及选择使用那些索引
- RDBMS 中索引一般使用 ==`B+Tree`==, ==`Hash索引`== 来实现
- 索引是关系数据库内部实现技术, 属于内模式的范畴
- 索引分类
	- 唯一索引
	- 非唯一索引
	- 聚簇索引
- 建立索引
	- `CREATE [UNIQUE] [CLUSTER] INDEX <索引名> ON <表名>(<列名i>[ASC | DESC], ...)`
	- UNIQUE: 
		- 建立唯一索引
		- 建立索引的这一列的值是唯一的
	- CLUSTER: 建立聚簇索引
		- 聚簇索引是索引顺序与表中记录的物理顺序一致的索引
		- 一个基本表上只能建立一个聚簇索引
		- 经常查询的列建议建立聚簇索引
		- 经常更新的列不建议建立聚簇索引
- 删除索引
	- `DROP INDEX <索引名>`
- 数据字典
	- 数据字典是关系数据库管理系统内部的一组系统表
	- 数据字典记录了数据库中所有的定义信息，包括模式定义、视图定义、索引定义、完整性约束定义、各类用户对数据库的操作权限、统计信息等
	- RDBMS 执行 SQL 数据定义时，实际就是更新数据字典

### 数据库安全性

#### 数据库的不安全因素

- 非授权对数据库的恶意存取和破坏
- 数据库中重要的数据泄露
- 安全环境的脆弱性

#### DBMS 的安全机制

- 自主安全性机制（自主存取控制）
	- 通过权限在用户之间的传递，使用户自主管理数据库安全性
- 强制安全性机制
	- 通过对数据和用户强制分类，使得不同类别用户能够访问不同类别的数据
- 推断控制机制
	- 防止通过公开信息推断出私密信息
- 数据加密存储机制


### 关系数据库理论

#### Armstrong 公理

> 对于 $R(U, F)$

- $A_1$ 自反律
	- 一个属性组可以决定它自身的任何属性的组合
- $A_2$ 增广律
	- 若 ${X}\rightarrow{Y}\in{F}$，且 ${Z}\subseteq{U}$，则 F 逻辑蕴含 ${XZ}\rightarrow{YZ}$
- $A_3$ 传递律
	- 若 ${X}\rightarrow{Y}\in{F}$，且 ${Y}\rightarrow{Z}$，则 F 逻辑蕴含 ${X}\rightarrow{Z}$
- 一些引理
	- 合并律
		- 若 ${X}\rightarrow{Y}$，${X}\rightarrow{Z}$，则 ${X}\rightarrow{YZ}$
	- 伪传递律
		- 若 ${X}\rightarrow{Y}$，${WY}\rightarrow{Z}$，则 ${XW}\rightarrow{Z}$
	- 分解律
		- 若 ${X}\rightarrow{Y}$，${Z}\subseteq{Y}$，则 ${X}\rightarrow{Z}$
	- 概括
		- 如果 $A_1, A_2, ..., A_n$ 是属性，则 ${X}\rightarrow{A_1, A_2, ..., A_n}$ 当且仅当对每个 ${A_i}$ 有 ${X}\rightarrow{A_i}(1 {\leq} i {\leq} n)$

#### Armstrong 关于多值依赖的公理

- A4 对称性
	- 若 ${X}\rightarrow\rightarrow{Y}$，则 ${X}\rightarrow\rightarrow{U-X-Y}$
- A5 增广律
	- 若 ${X}\rightarrow\rightarrow{Y}$，且 ${V}\subseteq{W}$，则 ${WX}\rightarrow\rightarrow{VY}$
- A6 传递律
	- 若 ${X}\rightarrow\rightarrow{Y}$，且 ${Y}\rightarrow\rightarrow{Z}$，则 ${X}\rightarrow\rightarrow{Z-Y}$
- A7
	- 若 ${X}\rightarrow{Y}$，则 ${X}\rightarrow\rightarrow{Y}$
- A8
	- 若 ${X}\rightarrow\rightarrow{Y}$，${Z}\subseteq{Y}$ 且对于某个与 Y 不相交的 W 有 W → Z，W$\cap$Y=Φ，则 ${X}\rightarrow{Z}$
- 一些引理
	- 合并律
		- 若 ${X}\rightarrow\rightarrow{Y}$，${X}\rightarrow\rightarrow{Z}$，则 ${X}\rightarrow\rightarrow{YZ}$
	- 伪传递律
		- 若 ${X}\rightarrow\rightarrow{Y}$，${WY}\rightarrow\rightarrow{Z}$，则 ${XW}\rightarrow\rightarrow{Z-WY}$

#### 范式

- 1NF
	- 所有的属性都是不可再分割的
	- 消除非主属性对码的部分函数依赖
- 2NF
	- 所有的非主属性都完全函数依赖于某一候选码
	- 消除非主属性对码的传递函数依赖
- 3NF
	- 不存在传递函数依赖
- BCNF
	- 若 $X{\rightarrow}Y$ 且 $Y{\nsubseteq}X$，则 X 必须包含一个候选码
	- 换而言之，关系模式 R 中每一个决定属性集都包含候选码
	- 所有主属性都完全函数依赖于每个不包含它的候选码
	- 不存在属性完全函数依赖于非码的任何一组属性
	- 消除主属性对码的部分和传递函数依赖
- 4NF
	- 多值依赖的左部一定是候选码
	- 消除非平凡且非函数依赖的多值依赖
- 5NF

### 数据库设计

步骤：

![](attachments/Pasted%20image%2020240702022341.png)

### 数据库安全性

![](attachments/Pasted%20image%2020240702022953.png)

![](attachments/Pasted%20image%2020240702023259.png)

### 并发控制

![](attachments/Pasted%20image%2020240702023416.png)

![](attachments/Pasted%20image%2020240702024113.png)

![](attachments/Pasted%20image%2020240702024523.png)

![](attachments/Pasted%20image%2020240702033056.png)

![](attachments/Pasted%20image%2020240702033359.png)

![](attachments/Pasted%20image%2020240702033740.png)