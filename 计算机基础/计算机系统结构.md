## 基本概念

### 计算机系统层次结构

![](attachments/Pasted%20image%2020240628224258.png)

![](attachments/Pasted%20image%2020240628224348.png)

### 计算机系统结构、组成与实现的关系

#### 计算机系统结构

- 经典定义
	- ==计算机体系结构是（汇编语言、机器语言）程序员所看到的计算机的属性，即概念性结构与功能特性==
- 现代定义
	- 三个特征
		- 指令集体系结构
		- 计算机组成与微体系结构
		- 硬件组成
- 对于通用寄存器型计算机，这些属性主要是指：
	- 数据表示
	- 寻址规则
	- 寄存器的定义
	- 指令系统
	- 中断系统
	- 机器工作状态的定义和切换
	- 存储系统
	- 信息保护
	- IO系统

#### 计算机组成

- 计算机组成是计算机系统结构的逻辑实现，它包括机器级内的数据流和控制流的组成以及逻辑设计，它是计算机系统的内特性
- 计算机组成着眼于机器级内部各事件的排序方式与控制机构、各部件的功能及各部件间的联系
- 指令系统的逻辑实现
	- 数据通路宽度
	- 各种操作对功能部件的共享程度
	- 专用功能部件的设置
	- 功能部件的并行性
	- 缓冲和排队技术
	- 预测技术
	- 可靠性技术
	- 控制机构的组成，等等

#### 计算机实现

- 计算机实现是指计算机组成的物理实现（具体电路，器件的设计，装配技术等等）
- 包括
	- 处理器、主存的物理结构
	- 器件的集成度和速度
	- 信号传输
	- 器件、模块、插件、底板的划分与连接
	- 涉及的专用器件
	- 电源、冷却
	- 微组装技术
	- 整机装配技术
- 着眼于器件技术和微组装技术，其中，==器件技术起着主导作用==
- 三者的关系
- ==先有计算机系统结构，后有计算机组成，最后是计算机实现==

### 计算机系统的设计准则

1. 加快经常性事件的速度
2. Amdahl 定律
3. 程序访问的局部性原理

### 计算机系统的设计思路

- 由下往上
- 由上往下
- 由中间向两边

### 计算机系统结构的设计步骤

> 计算机系统结构设计的主要任务是进行==软硬件功能分配==，==确定机器级的界面并对界面进行具体确切的定义==

- 基本步骤
	1. 需求分析
	2. 需求说明
	3. 概念性设计
	4. 具体设计
	5. 优化和评价

### 系列机和兼容

- 系列机是具有相同体系结构，但组成和实现不同的一系列不同型号的计算机系统
- 兼容可以分为
	- 二进制级兼容
	- 汇编级兼容
	- 高级语言兼容
	- 数据级兼容
- 向后兼容是才是软件兼容的根本特征，也是系列机的根本特征
- 系列机软件必须保证向后兼容，尽可能保证向上兼容

### Amdahl 定律

- a: 系统加速比
- Fe: 可改进比例，可改进部分在整个系统中所占的比例
- Se: 部件加速比，可改进部分性能提高的比例
- $a = {1\over{(1-Fe) + {{Fe}\over{Se}}}}$
- Amdahl定律揭示了
	- 仅仅对计算机中的一部分做性能改进，则改进越多，系统获得的效果越小
- 针对整个任务的一部分进行优化，则最大加速比不大于$1\over1-可改进比例$

## 指令系统

### 指令集结构概述

通用寄存器型指令集结构的主要优点：
- 在表达式求值方面，比其它类型指令集结构都具有更大的灵活性
- 寄存器可以用来存放变量
	- 减少存储器的通信量，加快程序的执行速度（因为寄存器比存储器快）
	- 可以用更少的地址位来寻址寄存器，从而可以有效改进程序的目标代码大小
- 通用寄存器型指令集的分类
	- RR
		- 优点
			- 指令字长固定，指令结构简洁，是一种简单的代码生成模型，各种指令的执行时钟周期数相近
		- 缺点
			- 与指令中含存储器操作数的指令系统结构相比，指令条数多，目标代码不够紧凑，因而程序占用的空间比较大
	- RM
		- 优点
			- 可以在ALU指令中直接对存储器操作数进行引用，面不必先用load指令进行加载，容易对指令进行编码，目标代码比较紧凌。
		- 缺点
			- 由于有一个操作数的内容将被破坏，所以指令中的两个操作数不对称。在一条指令中同时对寄存器操作数和存储器操作数进行编码，有可能限制指令所能够表示的寄存器个数。指令的执行时钟周期因操作数的来源（寄存器或存储器）的不同而差别比较大。
	- MM
		- 优点
			- 目标代码最紧凌，不需要设置存储器来保存变量
		- 缺点
			- 指令字长变化很大，特别是3个操作数指令。而且每条指令完成的工作也差别很大。对存储器的频繁访问会使存储器成为瓶颈。这种类型的指令系统现在已经不用了

### 指令集结构和 MIPS 指令集

#### 寻址技术

> 在通用寄存器型指令集结构中，一般是利用寻址方式指明指令中的操作数是一个常数、一个寄存器操作数，抑或是一个存储器操作数

![[attachments/Pasted image 20240621015107.png]]

#### 指令系统设计的基本原则

- 规整性
- 对称性
- 独立性和全能性
- 正交性
- 可组合性
- 可扩充性

#### 指令格式的优化

- 使指令的平均字长最短，减少程序总位数以及增加指令字能表示的操作信息和地址信息
- 哈夫曼压缩思想
	- 各种事件发生的概率不均等时，对发生概率最高的事件用最短的位数来表示，而对出现概率较低的事件允许用较长的位数来表示，就会使表示的平均位数缩短
- 扩展操作码编码

### 条件分支指令的表示

![[attachments/Pasted image 20240621030436.png]]

### 并行性的概念

- 并行分为
	- 并行
	- 并发
- 并行的粒度
	- 指令级并行
	- 线程级并行
	- 处理机并行
	- 计算机并行
- 提高并行性的技术途径
	- 时间重叠
		- 多个处理过程在时间上错开
	- 资源重复
		- 重复设置硬件资源来提高可靠性和性能
	- 资源共享
		- 多个用户按时间顺序轮流使用同一套资源
- 并行性等级（从低到高）
	- 按计算机系统执行程序的角度
		- 指令内部并行 -> 指令间并行 -> 任务（进程间）并行 -> 作业（程序）间并行
	- 从计算机系统中处理数据的角度
		- BSWS -> BPBS -> BSWP -> BPWP
- 计算机系统的分类
	- 单指令流单数据流（SISD）
	- 单指令流多数据流（SIMD）
	- 多指令流单数据流（MISD）
	- 多指令流多数据流（MIMD）
- 指令级并行
	- 流水线技术是实现 `指令级并行` 的重要技术
- 线程级并行
- 任务（过程）级并行

## 存储系统

> 对存储系统的基本要求是大容量、高速度和低价格

- 主存系统结构
	- 单体单字存储器
		- 一次访问一个存储器字，存储器字与CPU字相同
	- 单体多字存储器
		- 主存在一个存储周期内可读出多个CPU字
	- 多体单字存储器
		- 多个存储体，每个存储体一个存储字
	- 多体多字存储器
		- 多个存储体，每个存储体有多个存储字

## 中断系统

